<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visual Resume | Yilmaz Mustafa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #005F73;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: none;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* --- PDF Print Optimization Styles --- */
        @media print {
            body {
                background-color: #fff !important;
                color: #000 !important;
                margin: 0;
                padding: 0;
            }
            .container {
                padding: 0;
                margin: 0;
                max-width: none;
            }
            /* Remove shadows, which look bad on print */
            .shadow-lg, .shadow-sm {
                box-shadow: none !important;
                border: 1px solid #ddd !important;
            }
            /* Ensure text is black and headings are legible */
            h1, h2, h3, h4, p, span, a, time {
                color: #000 !important;
            }
            /* Hide the interactive tool for printing */
            #gemini-analysis, #exportResumeButton {
                display: none;
            }
            /* Ensure charts have enough space vertically */
            .chart-container {
                height: 300px !important;
                max-height: 350px !important;
            }
            /* Simplify project cards */
            .project-card {
                page-break-inside: avoid;
            }
            /* Make link colors black but retain underline */
            a {
                text-decoration: underline;
            }
        }
        /* Added class for project cards to ensure proper styling across environments */
        .project-card-border {
            border-left-width: 4px;
        }
        /* Styling for the Analysis Output */
        .analysis-content ul {
            list-style-type: disc;
            padding-left: 1.5rem;
            margin-top: 0.5rem;
        }
        .analysis-content strong {
            font-weight: 700;
        }
        /* Input styling for read-only state */
        textarea[readonly], input[readonly] {
            cursor: not-allowed;
            background-color: #f7f7f7;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">
<!--
    Color Palette Selection: Brilliant Blues
    - Primary: #005F73
    - Secondary: #0A9396
    - Accent: #94D2BD
    - Highlight: #E9D8A6
    - Background/Text: #EE9B00, #CA6702, #BB3E03, #AE2012, #9B2226
-->
<!-- Plan Narrative: 1. Snapshot (KPIs) 2. Contextual Skill Aligner (Offline Analysis). 3. Skills (Visual Charts) 4. Experience (Timeline) 5. Projects (List of cards). -->
<!-- Visualization Choices: KPIs (Single Big Number), Skills (Doughnut, Bar, Radar for different categories - Comparison/Inform), Projects (List of cards - Organization/Inform). Confirmed NO SVG. -->
<div class="container mx-auto p-4 md:p-8">
    <header class="text-center mb-12">
        <h1 class="text-5xl font-extrabold text-[#005F73]">YILMAZ MUSTAFA</h1>
        <p class="text-2xl font-light text-[#0A9396] mt-2">Java & Spring Software Engineer</p>
        <div class="mt-4 flex justify-center items-center space-x-4 text-slate-600">
            <span>üìß yilmaz@codesapien.net</span>
            <span class="text-[#94D2BD]">|</span>
            <span>üåê codesapien.net</span>
            <span class="text-[#94D2BD]">|</span>
            <span>üíº codesapienbe (LinkedIn)</span>
        </div>
        <!-- New Export Resume Button -->
        <button id="exportResumeButton" onclick="exportFullResume()" class="mt-6 flex items-center justify-center mx-auto space-x-2 bg-[#0A9396] hover:bg-[#005F73] text-white font-bold py-3 px-6 rounded-lg transition duration-200 shadow-md w-full max-w-sm md:max-w-xs">
            Export Resume as Word (DOC) üìÑ
        </button>
    </header>

    <main>
        <section id="summary" class="mb-16">
            <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-8">
                <h2 class="text-3xl font-bold text-center text-[#005F73] mb-6">Professional Snapshot</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                    <div>
                        <p class="text-6xl font-extrabold text-[#CA6702]">5+</p>
                        <p class="text-xl font-medium text-slate-700 mt-2">Years of Experience</p>
                        <p class="text-slate-500 mt-1">In enterprise application development.</p>
                    </div>
                    <div>
                        <p class="text-6xl font-extrabold text-[#BB3E03]">3</p>
                        <p class="text-xl font-medium text-slate-700 mt-2">Core Architectures</p>
                        <p class="text-slate-500 mt-1">Monolith, Microservices, and Modulith.</p>
                    </div>
                    <div>
                        <p class="text-6xl font-extrabold text-[#AE2012]">10k+</p>
                        <p class="text-xl font-medium text-slate-700 mt-2">Concurrent Users</p>
                        <p class="text-slate-500 mt-1">Supported in high-performance apps.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="gemini-analysis" class="mb-16">
            <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-8">
                <h2 class="text-3xl font-bold text-center text-[#005F73] mb-6">Contextual Skill Match üéØ</h2>
                <p class="text-slate-600 mb-2 text-center">Enter company details and paste a job description below for an instant analysis.</p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <input type="text" id="companyNameInput" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-[#0A9396] focus:border-[#0A9396] text-slate-700" placeholder="Target Company Name (e.g., Acme Corp)">
                    <input type="url" id="companyUrlInput" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-[#0A9396] focus:border-[#0A9396] text-slate-700" placeholder="Website URL (e.g., https://example.com)">
                </div>

                <textarea id="jobDescriptionInput" rows="6" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-[#0A9396] focus:border-[#0A9396] text-slate-700" placeholder="Paste the job description (e.g., Backend Engineer, Java/Kubernetes)..."></textarea>

                <div class="flex justify-center mt-4 space-x-4">
                    <button id="analyzeButton" class="flex items-center space-x-2 bg-[#EE9B00] hover:bg-[#CA6702] text-white font-bold py-3 px-6 rounded-lg transition duration-200 shadow-md w-full max-w-[200px]">
                        <span>Run Match üöÄ</span>
                        <div id="loadingSpinner" class="loading-spinner"></div>
                    </button>

                    <div id="exportContainer" class="hidden w-full max-w-[200px]">
                        <button id="exportButton" class="w-full flex items-center justify-center bg-[#0A9396] hover:bg-[#005F73] text-white font-bold py-3 px-6 rounded-lg transition duration-200 shadow-md">
                            Export Match Report üìÑ
                        </button>
                    </div>
                </div>

                <div id="analysisOutput" class="mt-8 pt-4 border-t border-slate-200">
                    <h3 class="text-xl font-bold text-[#0A9396] mb-2">Analysis Results:</h3>
                    <p id="outputPlaceholder" class="text-slate-500 italic">Results will appear here after analysis.</p>
                    <!-- Analysis Results are injected here -->
                    <div id="outputContent" class="text-slate-700 analysis-content"></div>
                </div>
            </div>
        </section>

        <section id="skills" class="mb-16">
            <h2 class="text-3xl font-bold text-center text-[#005F73] mb-8">Core Technical Expertise</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-xl font-bold text-[#0A9396] mb-4">Java & Enterprise Core</h3>
                    <p class="text-slate-600 mb-4">Deep expertise in the Java ecosystem, focusing on modern, high-performance backend development with the Spring Framework.</p>
                    <div class="chart-container h-64 md:h-72">
                        <canvas id="javaSkillsChart"></canvas>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-xl font-bold text-[#0A9396] mb-4">APIs & Database Tech</h3>
                    <p class="text-slate-600 mb-4">Strong command of API design and a wide range of database technologies, ensuring efficient data persistence and integration.</p>
                    <div class="chart-container h-64 md:h-72">
                        <canvas id="apiDbSkillsChart"></canvas>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6 md:col-span-2 lg:col-span-1">
                    <h3 class="text-xl font-bold text-[#0A9396] mb-4">DevOps, Cloud & Architecture</h3>
                    <p class="text-slate-600 mb-4">Proficient in modern DevOps practices, cloud platforms, and software architecture principles for building resilient systems.</p>
                    <div class="chart-container h-64 md:h-72">
                        <canvas id="devopsSkillsChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <section id="experience" class="mb-16">
            <h2 class="text-3xl font-bold text-center text-[#005F73] mb-8">Professional Journey</h2>
            <div class="relative border-l-4 border-[#94D2BD] ml-6 md:ml-0 md:mx-auto">
                <div class="mb-10 ml-8 md:ml-0">
                    <div class="absolute -left-1.5 mt-1.5 w-3 h-3 bg-[#005F73] rounded-full"></div>
                    <div class="md:grid md:grid-cols-2 md:gap-8">
                        <div class="md:text-right md:pr-8">
                            <time class="block mb-1 text-sm font-normal leading-none text-slate-500">Feb 2025 ‚Äì Aug 2025</time>
                            <h3 class="text-xl font-semibold text-[#005F73]">Software Engineer</h3>
                            <span class="text-sm font-medium text-[#0A9396]">(Freelance)</span>
                        </div>
                        <div class="p-4 bg-white rounded-lg border border-slate-200 shadow-sm mt-2 md:mt-0">
                            <p class="text-base font-normal text-slate-600">Developed and deployed high-performance Spring Boot 3.x apps, orchestrating CI/CD pipelines with Docker and Terraform.</p>
                        </div>
                    </div>
                </div>
                <div class="mb-10 ml-8 md:ml-0">
                    <div class="absolute -left-1.5 mt-1.5 w-3 h-3 bg-[#005F73] rounded-full"></div>
                    <div class="md:grid md:grid-cols-2 md:gap-8">
                        <div class="md:text-right md:pr-8">
                            <time class="block mb-1 text-sm font-normal leading-none text-slate-500">Oct 2024 ‚Äì Feb 2025</time>
                            <h3 class="text-xl font-semibold text-[#005F73]">Software Engineer</h3>
                            <p class="text-sm font-normal text-slate-500">TheMatchBox, Brussels</p>
                        </div>
                        <div class="p-4 bg-white rounded-lg border border-slate-200 shadow-sm mt-2 md:mt-0">
                            <p class="text-base font-normal text-slate-600">Enhanced search algorithms with ZeroMQ, improving latency by 15%, and implemented robust automated testing strategies.</p>
                        </div>
                    </div>
                </div>
                <div class="mb-10 ml-8 md:ml-0">
                    <div class="absolute -left-1.5 mt-1.5 w-3 h-3 bg-[#005F73] rounded-full"></div>
                    <div class="md:grid md:grid-cols-2 md:gap-8">
                        <div class="md:text-right md:pr-8">
                            <time class="block mb-1 text-sm font-normal leading-none text-slate-500">Jun 2023 ‚Äì Oct 2024</time>
                            <h3 class="text-xl font-semibold text-[#005F73]">Software Engineer</h3>
                            <p class="text-sm font-normal text-slate-500">SWIFT, La Hulpe</p>
                        </div>
                        <div class="p-4 bg-white rounded-lg border border-slate-200 shadow-sm mt-2 md:mt-0">
                            <p class="text-base font-normal text-slate-600">Maintained mission-critical financial messaging systems and upgraded security infrastructure with modern cryptographic standards.</p>
                        </div>
                    </div>
                </div>
                <div class="ml-8 md:ml-0">
                    <div class="absolute -left-1.5 mt-1.5 w-3 h-3 bg-[#005F73] rounded-full"></div>
                    <div class="md:grid md:grid-cols-2 md:gap-8">
                        <div class="md:text-right md:pr-8">
                            <time class="block mb-1 text-sm font-normal leading-none text-slate-500">Mar 2020 ‚Äì Jun 2023</time>
                            <h3 class="text-xl font-semibold text-[#005F73]">Software Engineer</h3>
                            <span class="text-sm font-medium text-[#0A9396]">& Instructor</span>
                        </div>
                        <div class="p-4 bg-white rounded-lg border border-slate-200 shadow-sm mt-2 md:mt-0">
                            <p class="text-base font-normal text-slate-600">Delivered enterprise Java and Spring Boot curriculum to over 100 developers and built CI/CD environments for training.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- NEW BLOCK: Architectural Competencies -->
        <section id="architecture" class="mb-16">
            <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-8">
                <h2 class="text-3xl font-bold text-center text-[#005F73] mb-6">Architectural Competencies</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                    <div>
                        <p class="text-xl font-extrabold text-[#0A9396]">Monolith</p>
                        <p class="text-slate-600 mt-1 text-sm">Experience maintaining and enhancing core enterprise applications.</p>
                    </div>
                    <div>
                        <p class="text-xl font-extrabold text-[#0A9396]">Microservices</p>
                        <p class="text-slate-600 mt-1 text-sm">Designed and deployed resilient, independently scalable service clusters.</p>
                    </div>
                    <div>
                        <p class="text-xl font-extrabold text-[#0A9396]">Modulith</p>
                        <p class="text-slate-600 mt-1 text-sm">Proficient in building well-structured, modular Spring applications (Spring Starters).</p>
                    </div>
                </div>
                <p class="text-sm text-slate-500 mt-4 text-center">Key concepts: Domain-Driven Design (DDD), Event-Driven Architecture, API Gateway, Service Mesh.</p>
            </div>
        </section>

        <section id="projects" class="mb-16">
            <h2 class="text-3xl font-bold text-center text-[#005F73] mb-8">Top 6 GitHub Open Source Projects</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-white rounded-xl shadow-lg p-6 md:col-span-2">
                    <p class="text-slate-600">Highlighting contributions across core Java frameworks, financial integration, and applied AI/ML in high-performance contexts (GitHub: codesapienbe).</p>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-6 project-card-border" style="border-left-color: #005F73;">
                    <h4 class="text-lg font-semibold text-[#005F73]">1. Spring Vision Framework üëÅÔ∏è</h4>
                    <p class="text-sm font-medium text-[#0A9396] mb-2">Technologies: Spring Boot 3.x, Java 21, OpenCV | <a href="https://github.com/codesapienbe/spring-vision" target="_blank" class="text-[#EE9B00] hover:text-[#CA6702]">GitHub Link</a></p>
                    <p class="text-slate-600 text-sm">A production-ready computer vision framework delivered as a **Spring Boot Starter**, enabling zero-configuration object detection, face analysis, and intelligent applications with enterprise security and high-performance pluggable backends.</p>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6 project-card-border" style="border-left-color: #0A9396;">
                    <h4 class="text-lg font-semibold text-[#005F73]">2. Spring Finqube ISO 20022 Starter üí∞</h4>
                    <p class="text-sm font-medium text-[#0A9396] mb-2">Technologies: Spring Boot 3.2, Financial Integration | <a href="https://github.com/codesapienbe/spring-finqube" target="_blank" class="text-[#EE9B00] hover:text-[#CA6702]">GitHub Link</a></p>
                    <p class="text-slate-600 text-sm">Developed a production-ready Spring Boot starter for **financial messaging** (ISO 20022 standard), featuring enterprise-grade security, auto-configuration, and a pluggable transport protocol pipeline.</p>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6 project-card-border" style="border-left-color: #94D2BD;">
                    <h4 class="text-lg font-semibold text-[#005F73]">3. Food Score MLOps Pipeline üìä</h4>
                    <p class="text-sm font-medium text-[#0A9396] mb-2">Technologies: Spring Boot, PostgreSQL, OpenAPI | <a href="https://github.com/codesapienbe/food-score" target="_blank" class="text-[#EE9B00] hover:text-[#CA6702]">GitHub Link</a></p>
                    <p class="text-slate-600 text-sm">Architected a complete enterprise application with structured JSON logging and **OpenAPI** documentation, demonstrating a full-cycle **MLOps** pipeline integration.</p>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6 project-card-border" style="border-left-color: #EE9B00;">
                    <h4 class="text-lg font-semibold text-[#005F73]">4. Instyper - Voice-to-Text Desktop App üéôÔ∏è</h4>
                    <p class="text-sm font-medium text-[#0A9396] mb-2">Technologies: Java, Vosk, Whisper, GUI | <a href="https://github.com/codesapienbe/Instyper" target="_blank" class="text-[#EE9B00] hover:text-[#CA6702]">GitHub Link</a></p>
                    <p class="text-slate-600 text-sm">A lightweight, privacy-first desktop application that turns your voice into text instantly. It works offline (Vosk) and supports modern online models (Whisper) and live translation.</p>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6 project-card-border" style="border-left-color: #CA6702;">
                    <h4 class="text-lg font-semibold text-[#005F73]">5. Stegnocchi - EXIF Steganography App üñºÔ∏è</h4>
                    <p class="text-sm font-medium text-[#0A9396] mb-2">Technologies: Core Java, Image Processing, Security | <a href="https://github.com/codesapienbe/Stegnocchi" target="_blank" class="text-[#EE9B00] hover:text-[#CA6702]">GitHub Link</a></p>
                    <p class="text-slate-600 text-sm">A security tool built in **Core Java** focused on hiding data within image metadata (**EXIF Steganography**), showcasing low-level data manipulation and security principles.</p>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6 project-card-border" style="border-left-color: #AE2012;">
                    <h4 class="text-lg font-semibold text-[#005F73]">6. DeepVoice - Voice Analysis Library üé§</h4>
                    <p class="text-sm font-medium text-[#0A9396] mb-2">Technologies: Python, AI/ML, Signal Processing | <a href="https://github.com/codesapienbe/DeepVoice" target="_blank" class="text-[#EE9B00] hover:text-[#CA6702]">GitHub Link</a></p>
                    <p class="text-slate-600 text-sm">A comprehensive **Python library** for voice analysis, processing, and **speaker identification**, reinforcing active interest and competency in the AI/ML domain.</p>
                </div>
            </div>
        </section>

        <!-- ENHANCED BLOCK: Professional Development & Training -->
        <section id="development" class="mb-16">
            <h2 class="text-3xl font-bold text-center text-[#005F73] mb-8">Professional Development & Training</h2>
            <div class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Certifications Card -->
                <div class="bg-white rounded-xl shadow-lg p-6 border-t-4 border-[#EE9B00]">
                    <h3 class="text-xl font-bold text-[#0A9396] mb-4 flex items-center">
                        Certifications & Internal Training üèÜ
                    </h3>
                    <ul class="list-none space-y-3 text-sm text-slate-700">
                        <li class="pl-4 relative before:content-['‚Ä¢'] before:absolute before:left-0 before:text-[#EE9B00] before:font-bold">
                            **Agile in Software Engineering** (SWIFT Internal Training)
                        </li>
                        <li class="pl-4 relative before:content-['‚Ä¢'] before:absolute before:left-0 before:text-[#EE9B00] before:font-bold">
                            **Spring Boot and Angular** (VDAB Internal Training)
                        </li>
                        <li class="pl-4 relative before:content-['‚Ä¢'] before:absolute before:left-0 before:text-[#EE9B00] before:font-bold">
                            **Enterprise Java Development** (INTEC Brussel Training)
                        </li>
                        <li class="pl-4 relative before:content-['‚Ä¢'] before:absolute before:left-0 before:text-[#EE9B00] before:font-bold">
                            Certifications in Agile and Security (Self-Study)
                        </li>
                    </ul>
                </div>
                <!-- Coursework Card -->
                <div class="bg-white rounded-xl shadow-lg p-6 border-t-4 border-[#CA6702]">
                    <h3 class="text-xl font-bold text-[#0A9396] mb-4 flex items-center">
                        Specialized Coursework üíª
                    </h3>
                    <ul class="list-none space-y-3 text-sm text-slate-700">
                        <li class="pl-4 relative before:content-['‚Ä¢'] before:absolute before:left-0 before:text-[#CA6702] before:font-bold">
                            **C and System Programming** (Istanbul, Turkiye)
                        </li>
                        <li class="pl-4 relative before:content-['‚Ä¢'] before:absolute before:left-0 before:text-[#CA6702] before:font-bold">
                            **System and Networking** (Bursa, Turkiye)
                        </li>
                        <li class="pl-4 relative before:content-['‚Ä¢'] before:absolute before:left-0 before:text-[#CA6702] before:font-bold">
                            **Graphical and Web Design** (Istanbul, Turkiye)
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- ENHANCED BLOCK: Education & Languages -->
        <section id="education" class="mb-16">
            <h2 class="text-3xl font-bold text-center text-[#005F73] mb-8">Education & Global Competencies</h2>
            <div class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Academic History Card (Spanning 2 columns) -->
                <div class="bg-white rounded-xl shadow-lg p-6 border-t-4 border-[#0A9396] md:col-span-2">
                    <h3 class="text-xl font-bold text-[#0A9396] mb-4">Academic History üéì</h3>
                    <div class="space-y-4">
                        <div>
                            <p class="text-lg font-semibold text-slate-800">Postgraduate AI & Machine Learning (Completed)</p>
                            <p class="text-sm text-slate-600">Erasmushogeschool Brussel, Belgium</p>
                        </div>
                        <div>
                            <p class="text-lg font-semibold text-slate-800">MSc in Computing and Information Systems (Incomplete)</p>
                            <p class="text-sm text-slate-600">Queen Mary, University of London, UK (2013)</p>
                        </div>
                        <div>
                            <p class="text-lg font-semibold text-slate-800">Bachelor Degree, Tourism and Hotel Management</p>
                            <p class="text-sm text-slate-600">Beykent University, Istanbul, Turkiye (2010)</p>
                        </div>
                    </div>
                </div>
                <!-- Languages & Domain Card -->
                <div class="bg-white rounded-xl shadow-lg p-6 border-t-4 border-[#005F73]">
                    <h3 class="text-xl font-bold text-[#0A9396] mb-4">Languages & Domain üó£Ô∏è</h3>
                    <div class="space-y-3">
                        <p class="text-base font-semibold text-slate-800">Language Proficiency</p>
                        <ul class="list-none space-y-1 text-sm text-slate-700">
                            <li class="pl-4 relative before:content-['‚Ä¢'] before:absolute before:left-0 before:text-[#005F73] before:font-bold">**Turkish**: Native</li>
                            <li class="pl-4 relative before:content-['‚Ä¢'] before:absolute before:left-0 before:text-[#005F73] before:font-bold">**English**: Fluent</li>
                            <li class="pl-4 relative before:content-['‚Ä¢'] before:absolute before:left-0 before:text-[#005F73] before:font-bold">**Dutch**: Professional</li>
                        </ul>
                        <p class="text-base font-semibold text-slate-800 mt-4">Domain Expertise</p>
                        <ul class="list-none space-y-1 text-sm text-slate-700">
                            <li class="pl-4 relative before:content-['‚Ä¢'] before:absolute before:left-0 before:text-[#005F73] before:font-bold">Financial Messaging (SWIFT, ISO 20022)</li>
                            <li class="pl-4 relative before:content-['‚Ä¢'] before:absolute before:left-0 before:text-[#005F73] before:font-bold">Enterprise Software & SaaS</li>
                            <li class="pl-4 relative before:content-['‚Ä¢'] before:absolute before:left-0 before:text-[#005F73] before:font-bold">Technical Training</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="text-center mt-12 pt-8 border-t border-slate-200">
        <div class="flex justify-center space-x-6 text-slate-600">
            <a href="mailto:yilmaz@codesapien.net" class="hover:text-[#0A9396] transition duration-200" title="Email: yilmaz@codesapien.net">üìß Email</a>
            <a href="https://codesapien.net" target="_blank" class="hover:text-[#0A9396] transition duration-200" title="Portfolio: codesapien.net">üåê Portfolio</a>
            <a href="https://www.linkedin.com/in/codesapienbe" target="_blank" class="hover:text-[#0A9396] transition duration-200" title="LinkedIn: codesapienbe">üíº LinkedIn</a>
            <a href="https://github.com/codesapienbe" target="_blank" class="hover:text-[#0A9396] transition duration-200" title="GitHub: codesapienbe">üêô GitHub</a>
        </div>
        <p class="text-sm text-slate-500 mt-4">Visual Resume for Yilmaz Mustafa.</p>
    </footer>
</div>

<script>
    // --- CHART.JS CONFIGURATION ---
    const tooltipTitleCallback = {
        plugins: {
            tooltip: {
                callbacks: {
                    title: function(tooltipItems) {
                        const item = tooltipItems[0];
                        let label = item.chart.data.labels[item.dataIndex];
                        if (Array.isArray(label)) {
                            return label.join(' ');
                        }
                        return label;
                    }
                }
            }
        }
    };

    const colors = {
        primary: '#005F73',
        secondary: '#0A9396',
        accent: '#94D2BD',
        highlight: '#E9D8A6',
        danger1: '#EE9B00',
        danger2: '#CA6702',
        danger3: '#BB3E03',
        danger4: '#AE2012'
    };

    new Chart(document.getElementById('javaSkillsChart'), {
        type: 'doughnut',
        data: {
            labels: ['Spring Boot 3.x', 'Java 17-21+', 'Spring Security', 'Java EE'],
            datasets: [{
                label: 'Java & Enterprise Core',
                data: [40, 45, 10, 5],
                backgroundColor: [colors.primary, colors.secondary, colors.accent, colors.highlight],
                borderColor: '#fff',
                borderWidth: 2
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                ...tooltipTitleCallback.plugins,
                legend: {
                    position: 'bottom',
                },
            }
        }
    });

    new Chart(document.getElementById('apiDbSkillsChart'), {
        type: 'bar',
        data: {
            labels: ['REST APIs', 'PostgreSQL', ['JPA', 'Hibernate'], 'Oracle', 'GraphQL', 'MongoDB'],
            datasets: [{
                label: 'Proficiency',
                data: [95, 85, 90, 75, 70, 65],
                backgroundColor: [colors.primary, colors.secondary, colors.accent, colors.danger2, colors.highlight, colors.danger3],
                borderRadius: 4
            }]
        },
        options: {
            indexAxis: 'y',
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: {
                    beginAtZero: true,
                    max: 100,
                    grid: { display: false }
                },
                y: { grid: { display: false } }
            },
            plugins: {
                ...tooltipTitleCallback.plugins,
                legend: {
                    display: false
                }
            }
        }
    });

    new Chart(document.getElementById('devopsSkillsChart'), {
        type: 'radar',
        data: {
            labels: ['Docker', 'Kubernetes', 'Jenkins', 'Terraform', 'CI/CD', 'Architecture'],
            datasets: [{
                label: 'DevOps & Architecture Skills',
                data: [90, 70, 85, 80, 95, 88],
                fill: true,
                backgroundColor: 'rgba(10, 147, 150, 0.2)',
                borderColor: colors.secondary,
                pointBackgroundColor: colors.secondary,
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: colors.secondary
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                ...tooltipTitleCallback.plugins,
                legend: {
                    position: 'bottom',
                },
            },
            scales: {
                r: {
                    angleLines: {
                        color: 'rgba(0, 0, 0, 0.1)'
                    },
                    suggestedMin: 0,
                    suggestedMax: 100,
                    pointLabels: {
                        font: {
                            size: 12
                        }
                    }
                }
            }
        }
    });

    // --- LOCAL SKILL MATCHER DATA & LOGIC ---
    const candidateSkills = [
        'Java 21', 'Java 17', 'Spring Boot 3.x', 'Spring Cloud', 'Spring Security', 'REST', 'SOAP',
        'PostgreSQL', 'Oracle', 'JPA', 'Hibernate', 'GraphQL', 'Docker', 'Kubernetes',
        'Terraform', 'Jenkins', 'CI/CD', 'DevOps', 'Microservices', 'Modulith', 'Monolith',
        'TDD', 'JUnit 5', 'Mockito', 'OpenAPI', 'Swagger', 'Messaging', 'MQ', 'Python', 'Computer Vision'
    ];

    const experiencePoints = [
        { keyword: 'concurrent users', context: 'Supported 10k+ concurrent users in high-performance Spring Boot apps (Freelance).' },
        { keyword: 'CI/CD', context: 'Orchestrated CI/CD pipelines with Docker and Terraform (Freelance).' },
        { keyword: 'financial messaging', context: 'Maintained mission-critical financial messaging systems (SWIFT AMH).' },
        { keyword: 'security', context: 'Executed security upgrades using cryptographic standards (SWIFT).' },
        { keyword: 'testing', context: 'Implemented robust automated testing strategies (TheMatchBox).' },
        { keyword: 'algorithms', context: 'Enhanced search algorithms using ZeroMQ (15% latency reduction).' },
        { keyword: 'starter', context: 'Developed Spring Boot Starter frameworks (Spring Vision, Finqube).' },
        { keyword: 'AI/ML', context: 'Experience building AI/ML applications (Spring Vision, DeepVoice).' },
        { keyword: 'Docker', context: 'Used Docker and Terraform for deployment (Freelance).' }
    ];

    const companyNameInput = document.getElementById('companyNameInput');
    const companyUrlInput = document.getElementById('companyUrlInput');
    const analyzeButton = document.getElementById('analyzeButton');
    const jobDescriptionInput = document.getElementById('jobDescriptionInput');
    const outputContent = document.getElementById('outputContent');
    const outputPlaceholder = document.getElementById('outputPlaceholder');
    const loadingSpinner = document.getElementById('loadingSpinner');
    const exportContainer = document.getElementById('exportContainer');
    const exportButton = document.getElementById('exportButton');

    let lastAnalysisResult = {
        matchScore: 0,
        matchedSkills: [],
        alignmentHits: [],
        jobDescription: '',
        companyName: '',
        companyUrl: ''
    };

    const markdownToHtml = (markdownText) => {
        let html = markdownText;

        // Convert newlines to <br> for basic formatting
        html = html.replace(/(\r\n|\n|\r)/gm, '<br>');

        // Bold: **text** or __text__ to <strong>
        html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
        html = html.replace(/\_\_(.*?)\_\_/g, '<strong>$1</strong>');

        // Italic: *text* or _text_ to <em>
        html = html.replace(/\*(.*?)\*/g, '<em>$1</em>');
        html = html.replace(/\_(.*?)\_/g, '<em>$1</em>');

        return html;
    };

    const runLocalMatch = (jobDescription, companyName, companyUrl) => {
        const jdLower = jobDescription.toLowerCase();
        const skillHits = {};
        let totalMatchCount = 0;

        // 1. Convert Job Description for display (Preview logic)
        const formattedJobDescription = markdownToHtml(jobDescription);

        // Set input field as preview and read-only
        jobDescriptionInput.innerHTML = formattedJobDescription;
        jobDescriptionInput.readOnly = true;
        companyNameInput.readOnly = true;
        companyUrlInput.readOnly = true;


        // 2. Calculate Skill Matches
        candidateSkills.forEach(skill => {
            const skillLower = skill.toLowerCase();
            const regex = new RegExp('\\b' + skillLower.replace(/[.*+?^${}()|[\]\\]/g, '\\$&') + '\\b', 'g');
            if (jdLower.match(regex)) {
                skillHits[skill] = (skillHits[skill] || 0) + 1;
                totalMatchCount++;
            }
        });

        // Sort matched skills by hit count (and then alphabetically)
        const matchedSkills = Object.entries(skillHits)
            .sort(([, a], [, b]) => b - a)
            .slice(0, 5)
            .map(([skill]) => skill);

        // 3. Calculate Contextual Alignment
        const alignmentHits = [];
        experiencePoints.forEach(point => {
            if (jdLower.includes(point.keyword.toLowerCase())) {
                alignmentHits.push(point.context);
            }
        });

        // 4. Generate Output and Update Cache
        const matchScore = Math.min(Math.round((totalMatchCount / 10) * 100), 100);

        lastAnalysisResult = {
            matchScore,
            matchedSkills,
            alignmentHits,
            jobDescription,
            companyName,
            companyUrl
        };

        // Generate Simulated Security Report
        const securityReport = generateSimulatedSecurityReport(companyUrl);

        // Format HTML Output
        const formattedSkills = matchedSkills.map(s => `<li>${s}</li>`).join('\n') || '<li>No direct keyword matches found.</li>';
        const formattedAlignment = alignmentHits.map(h => `<li>Relevant Experience: ${h}</li>`).join('\n') || '<li>No direct experience context matches found.</li>';
        const formattedSecurity = securityReport.map(item => `<li class="text-xs">${item.status} ${item.check}: ${item.result}</li>`).join('\n');


        const analysisOutput = `
                <p><strong>Match Score: ${matchScore}% üéØ</strong><br>
                (Based on alignment of top 20 prioritized keywords)</p>

                <hr class="my-3 border-t border-slate-300">

                <p><strong>Top ${matchedSkills.length} Matching Skills/Keywords:</strong></p>
                <ul>
                    ${formattedSkills}
                </ul>

                <hr class="my-3 border-t border-slate-300">

                <p><strong>Key Experience Alignment:</strong></p>
                <ul>
                    ${formattedAlignment}
                </ul>

                <hr class="my-3 border-t border-slate-300">

                <p><strong>Simulated Initial Security Assessment:</strong></p>
                <ul class="space-y-1">
                    ${formattedSecurity}
                </ul>
                <p class="text-xs text-slate-500 mt-2"><em>*This is a simulated report for presentation purposes only, based on assumed security best practices.</em></p>
            `;


        outputContent.innerHTML = `<div class="bg-slate-50 p-4 rounded-lg border border-slate-200 overflow-x-auto text-sm">${analysisOutput}</div>`;
        exportContainer.classList.remove('hidden');
    };

    // --- SIMULATED SECURITY CHECK LOGIC ---
    const generateSimulatedSecurityReport = (url) => {
        const isHttps = url.toLowerCase().startsWith('https');
        const domain = url.replace(/https?:\/\//i, '').split('/')[0];

        const results = [
            {
                check: 'HTTPS Encryption (TLS/SSL)',
                result: isHttps ? 'Strong baseline security detected.' : 'Missing. Recommended: Implement HTTPS (TLS 1.2+).',
                status: isHttps ? '‚úÖ' : '‚ö†Ô∏è'
            },
            {
                check: 'HSTS Header Enforcement',
                result: 'Assumed strong. Promotes use of secure connections only.',
                status: '‚úÖ'
            },
            {
                check: 'Content Security Policy (CSP)',
                result: 'Assumed basic. Reduces risks from cross-site scripting (XSS) and injection attacks.',
                status: '‚òëÔ∏è'
            },
            {
                check: 'Subresource Integrity (SRI) Check',
                result: 'Assumed compliance. Verifies external scripts haven\'t been tampered with.',
                status: '‚úÖ'
            },
            {
                check: 'Domain Security Health',
                result: `Domain ${domain} is assumed to have standard security headers.`,
                status: '‚ÑπÔ∏è'
            },
        ];
        return results;
    };

    analyzeButton.addEventListener('click', () => {
        const jobDescription = jobDescriptionInput.value.trim();
        const companyName = companyNameInput.value.trim();
        const companyUrl = companyUrlInput.value.trim();

        if (!jobDescription || !companyName || !companyUrl) {
            outputContent.innerHTML = '<span class="text-[#AE2012]">Please fill in the Company Name, URL, and Job Description to run the analysis.</span>';
            outputPlaceholder.style.display = 'none';
            exportContainer.classList.add('hidden');
            return;
        }

        loadingSpinner.style.display = 'inline-block';
        analyzeButton.disabled = true;
        outputPlaceholder.style.display = 'none';
        outputContent.innerHTML = '';

        setTimeout(() => {
            runLocalMatch(jobDescription, companyName, companyUrl);
            loadingSpinner.style.display = 'none';
            analyzeButton.disabled = false;
        }, 100);
    });

    // Add handler to reset state when user clears the input
    const resetState = () => {
        jobDescriptionInput.readOnly = false;
        companyNameInput.readOnly = false;
        companyUrlInput.readOnly = false;
        jobDescriptionInput.innerHTML = jobDescriptionInput.value; // Restore raw text content
        outputPlaceholder.style.display = 'block';
        outputContent.innerHTML = '';
        exportContainer.classList.add('hidden');
    }

    jobDescriptionInput.addEventListener('input', () => {
        if (jobDescriptionInput.readOnly && jobDescriptionInput.value.trim() !== '') {
            // If the user starts typing in the read-only preview, reset the state
            resetState();
        } else if (jobDescriptionInput.value.trim() === '') {
            // If input is cleared, ensure full reset
            resetState();
        }
    });

    // Also allow clearing if name/url change after analysis
    companyNameInput.addEventListener('input', () => { if (jobDescriptionInput.readOnly) resetState(); });
    companyUrlInput.addEventListener('input', () => { if (jobDescriptionInput.readOnly) resetState(); });


    // --- WORD EXPORT LOGIC ---
    const exportMatchReport = () => {
        const { matchScore, matchedSkills, alignmentHits, jobDescription, companyName, companyUrl } = lastAnalysisResult;

        // Convert raw job description using markdownToHtml for the Word document
        const htmlJobDescription = markdownToHtml(jobDescription);

        const htmlSkills = matchedSkills.map(s => `<li>${s}</li>`).join('');
        const htmlAlignment = alignmentHits.map(h => `<li>${h}</li>`).join('');

        const securityReport = generateSimulatedSecurityReport(companyUrl);
        const htmlSecurity = securityReport.map(item => `
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 8px 0; font-size: 10pt; width: 20%;">${item.status}</td>
                    <td style="padding: 8px 0; font-size: 10pt; width: 35%; font-weight: bold;">${item.check}</td>
                    <td style="padding: 8px 0; font-size: 10pt; width: 45%;">${item.result}</td>
                </tr>`).join('');


        const docContent = `
                <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
                <head>
                    <meta charset='utf-8'>
                    <title>Skill Match Report - Yilmaz Mustafa</title>
                    <style>
                        body { font-family: Arial, sans-serif; line-height: 1.6; max-width: 800px; margin: 40px auto; color: #333; }
                        h1 { color: #005F73; border-bottom: 3px solid #005F73; padding-bottom: 10px; margin-top: 0; }
                        h2 { color: #0A9396; border-bottom: 1px solid #0A9396; padding-bottom: 5px; margin-top: 30px; }
                        h3 { margin-top: 20px; font-size: 12pt; color: #005F73; }
                        .header { text-align: center; margin-bottom: 40px; }
                        .header h1 { font-size: 28pt; border: none; }
                        .contact { font-size: 10pt; color: #666; }
                        .score { font-size: 20pt; font-weight: bold; color: #AE2012; margin: 15px 0; text-align: center;}
                        .job-desc { border: 1px solid #ddd; padding: 15px; background: #f9f9f9; margin-bottom: 20px; }
                        ul { padding-left: 20px; list-style-type: disc; }
                        li { margin-bottom: 5px; }
                        .table-container { width: 100%; border-collapse: collapse; margin-top: 10px; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>Yilmaz Mustafa - Job Match Report</h1>
                        <p class="contact">
                            Email: yilmaz@codesapien.net | LinkedIn: codesapienbe | Portfolio: codesapien.net
                        </p>
                    </div>

                    <h2>Target Company Profile</h2>
                    <table style="width: 100%; font-size: 11pt;">
                        <tr><td style="width: 30%; font-weight: bold;">Company Name:</td><td>${companyName}</td></tr>
                        <tr><td style="font-weight: bold;">Website:</td><td><a href="${companyUrl}">${companyUrl}</a></td></tr>
                    </table>

                    <h2>Job Alignment Summary</h2>
                    <div class="score">Match Score: ${matchScore}%</div>

                    <h3>Job Description Provided</h3>
                    <div class="job-desc">${htmlJobDescription}</div>

                    <h2>Matched Technical Skills</h2>
                    <p>The following top technical skills from Yilmaz Mustafa's profile were identified in the job description:</p>
                    <ul>${htmlSkills}</ul>

                    <h2>Contextual Experience Alignment</h2>
                    <p>Yilmaz Mustafa possesses direct experience relevant to these key requirements mentioned in the job description:</p>
                    <ul>${htmlAlignment}</ul>

                    <h2>Initial Security Assessment (Simulated)</h2>
                    <table class="table-container">
                        <thead>
                            <tr style="background-color: #f0f0f0;">
                                <th style="text-align: left; padding: 8px 0;">Status</th>
                                <th style="text-align: left; padding: 8px 0;">Security Check</th>
                                <th style="text-align: left; padding: 8px 0;">Finding</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${htmlSecurity}
                        </tbody>
                    </table>
                    <p style="margin-top: 15px; font-size: 9pt; color: #AE2012;">
                        *This security assessment is simulated and intended for professional presentation only. Live security auditing requires dedicated services and server-side processing.*
                    </p>


                    <p style="margin-top: 40px; font-size: 10pt; color: #666;">
                        This report was generated automatically based on a proprietary client-side keyword matching algorithm.
                    </p>
                </body>
                </html>
            `;

        const filename = `Yilmaz_Mustafa_Match_Report_${companyName.replace(/\s/g, '_')}.doc`;
        const blob = new Blob(['\ufeff', docContent], {
            type: 'application/msword'
        });

        // Use the standard download method
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    };

    // --- FULL RESUME EXPORT LOGIC (Enhanced Visual Design) ---
    const exportFullResume = () => {
        // Define the simple, non-interactive resume content for export
        const exportData = {
            title: "Yilmaz Mustafa",
            subtitle: "Java & Spring Software Engineer",
            contact: "Email: yilmaz@codesapien.net | Portfolio: codesapien.net | LinkedIn: codesapienbe",
            summary: "Software Engineer with 5+ years of expertise in enterprise application development using Spring Boot and modern software architecture (Monolith, Microservices, Modulith). Proven track record delivering scalable, high-performance applications and CI/CD automation. Supported 10k+ concurrent users and specialized in REST/SOAP APIs and data integration.",
            skills: candidateSkills, // Reuse core skill list
            experience: [
                { company: "Freelance", title: "Software Engineer", dates: "Feb 2025 ‚Äì Aug 2025", desc: "Developed and deployed high-performance Spring Boot 3.x apps, orchestrating CI/CD pipelines with Docker and Terraform." },
                { company: "TheMatchBox, Brussels", title: "Software Engineer", dates: "Oct 2024 ‚Äì Feb 2025", desc: "Enhanced search algorithms with ZeroMQ, improving latency by 15%, and implemented robust automated testing strategies." },
                { company: "SWIFT, La Hulpe", title: "Software Engineer", dates: "Jun 2023 ‚Äì Oct 2024", desc: "Maintained mission-critical financial messaging systems (AMH) and upgraded security infrastructure with modern cryptographic standards." },
                { company: "INTEC Brussel", title: "Software Engineer & Instructor", dates: "Mar 2020 ‚Äì Jun 2023", desc: "Delivered enterprise Java and Spring Boot curriculum to over 100 developers and built CI/CD environments for training." },
            ],
            projects: [
                { name: "Spring Vision Framework", tech: "Spring Boot 3.x, Java 21, OpenCV", desc: "A production-ready computer vision framework delivered as a Spring Boot Starter, enabling zero-configuration object detection and intelligent applications." },
                { name: "Spring Finqube ISO 20022 Starter", tech: "Spring Boot 3.2, Financial Integration", desc: "Developed a Spring Boot starter for financial messaging (ISO 20022 standard), featuring enterprise-grade security and auto-configuration." },
                { name: "Instyper - Voice-to-Text Desktop App", tech: "Java, Vosk, Whisper, GUI", desc: "A lightweight, privacy-first desktop application that turns your voice into text instantly, working offline and supporting modern online models." },
                { name: "Food Score MLOps Pipeline", tech: "Spring Boot, PostgreSQL, OpenAPI", desc: "Architected an enterprise application with structured JSON logging and OpenAPI documentation, demonstrating a full-cycle MLOps pipeline integration." },
            ],
            education: [
                { title: "Postgraduate AI & Machine Learning (Completed)", institution: "Erasmushogeschool Brussel, Belgium" },
                { title: "MSc in Computing and Information Systems (Incomplete)", institution: "Queen Mary, University of London, UK (2013)" },
                { title: "Bachelor Degree, Tourism and Hotel Management", institution: "Beykent University, Istanbul, Turkiye (2010)" },
            ],
            certifications: [
                "Agile in Software Engineering (SWIFT Internal Training)",
                "Spring Boot and Angular (VDAB Internal Training)",
                "Enterprise Java Development (INTEC Brussel Training)",
                "Certifications in Agile and Security",
            ]
        };

        // Fix 1: Professional Experience layout using reliable divs/spans
        const htmlExperience = exportData.experience.map(exp => `
                <div style="margin-bottom: 18px; border-left: 3px solid #94D2BD; padding-left: 10px;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr style="vertical-align: top;">
                            <td style="width: 75%;">
                                <h3 style="margin: 0; font-size: 11pt; color: #005F73; font-weight: bold;">${exp.title}</h3>
                                <p style="margin: 0; font-size: 9pt; color: #0A9396; font-weight: normal;">${exp.company}</p>
                            </td>
                            <td style="width: 25%; text-align: right; font-size: 9pt; color: #666; font-weight: bold;">${exp.dates}</td>
                        </tr>
                    </table>
                    <p style="margin: 5px 0 0 0; font-size: 10pt; color: #333;">- ${exp.desc}</p>
                </div>
            `).join('');

        const htmlProjects = exportData.projects.map(proj => `
                <div style="margin-bottom: 12px; border-left: 3px solid #E9D8A6; padding-left: 8px;">
                    <h3 style="margin: 0; font-size: 10.5pt; color: #005F73; font-weight: bold;">${proj.name}</h3>
                    <p style="font-size: 9pt; color: #0A9396; margin: 2px 0;">Tech: ${proj.tech}</p>
                    <p style="font-size: 10pt; margin: 2px 0;">- ${proj.desc}</p>
                </div>
            `).join('');

        const htmlSkillsList = exportData.skills.map(s => `
                <span style="background-color: #f0f0f0; padding: 3px 8px; border-radius: 3px; margin: 0 5px 5px 0; font-size: 9pt; display: inline-block;">${s}</span>
            `).join('');

        const htmlEducation = exportData.education.map(edu => `
                 <h3 style="margin: 10px 0 0 0; font-size: 10pt; color: #0A9396; font-weight: bold;">${edu.title}</h3>
                 <p style="margin: 0 0 5px 0; font-size: 9pt; color: #666;">${edu.institution}</p>
            `).join('');

        const htmlCertifications = exportData.certifications.map(cert => `
                <li>${cert}</li>
            `).join('');

        const htmlArchitecturalCompetencies = `
                <p style="font-size: 10pt; margin: 5px 0 10px 0; color: #005F73; font-weight: bold;">Architectures:</p>
                <ul style="padding-left: 20px; list-style-type: disc; font-size: 10pt; margin-bottom: 5px;">
                    <li>Monolith (Experience maintaining and enhancing core enterprise applications)</li>
                    <li>Microservices (Designed and deployed resilient, independently scalable service clusters)</li>
                    <li>Modulith (Proficient in building well-structured, modular Spring applications)</li>
                </ul>
                <p style="font-size: 9pt; margin-top: 10px; color: #666;">Key concepts: Domain-Driven Design (DDD), Event-Driven Architecture, API Gateway, Service Mesh.</p>
            `;

        // Fix 2: Education and Development section using robust table structure
        const htmlEducationDevelopment = `
                <table style="width: 100%; border-collapse: collapse;">
                    <tr style="vertical-align: top;">
                        <!-- Left Column: Education and Languages -->
                        <td style="width: 50%; padding-right: 20px;">
                            <h3 style="font-size: 12pt; color: #0A9396; margin-bottom: 5px;">Education</h3>
                            ${htmlEducation}

                            <h3 style="font-size: 12pt; color: #0A9396; margin-bottom: 5px; margin-top: 15px;">Languages & Domain</h3>
                             <p style="font-size: 10pt; font-weight: bold; margin: 5px 0 3px 0;">Language Proficiency:</p>
                             <ul style="padding-left: 20px; list-style-type: disc; margin-top: 0; font-size: 10pt;">
                                <li>Turkish (Native), English (Fluent), Dutch (Professional)</li>
                            </ul>
                             <p style="font-size: 10pt; font-weight: bold; margin: 5px 0 3px 0;">Domain Expertise:</p>
                             <ul style="padding-left: 20px; list-style-type: disc; margin-top: 0; font-size: 10pt;">
                                <li>Financial Messaging, Enterprise Software, Technical Training</li>
                            </ul>
                        </td>
                        <!-- Right Column: Certifications & Training -->
                        <td style="width: 50%; padding-left: 10px; border-left: 1px solid #ddd;">
                            <h3 style="font-size: 12pt; color: #0A9396; margin-bottom: 5px;">Certifications & Training</h3>
                            <ul style="padding-left: 20px; list-style-type: disc; margin-top: 5px; font-size: 10pt;">
                                ${htmlCertifications}
                            </ul>
                        </td>
                    </tr>
                </table>
            `;


        const docContent = `
                <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
                <head>
                    <meta charset='utf-8'>
                    <title>Resume - Yilmaz Mustafa</title>
                    <style>
                        body { font-family: Arial, sans-serif; line-height: 1.4; max-width: 850px; margin: 0; color: #333; }
                        .section-header { color: #005F73; border-bottom: 2px solid #005F73; padding: 5px 0 3px 0; margin-top: 25px; margin-bottom: 15px; font-size: 15pt; font-weight: bold; }
                        .header-block { background-color: #f7f7f7; padding: 20px; text-align: center; margin-bottom: 20px; border-radius: 5px;}
                        .contact { font-size: 10pt; color: #666; margin-top: 5px; }
                        .summary { font-size: 11pt; margin-top: 15px; margin-bottom: 20px; line-height: 1.5; }
                    </style>
                </head>
                <body>
                    <div class="header-block">
                        <h1 style="font-size: 24pt; font-weight: bold; color: #005F73; margin: 0;">${exportData.title}</h1>
                        <p style="font-size: 14pt; color: #0A9396; margin: 0;">${exportData.subtitle}</p>
                        <p class="contact">${exportData.contact}</p>
                    </div>

                    <div style="padding: 0 20px;">

                        <div class="section-header">PROFESSIONAL SUMMARY</div>
                        <p class="summary">${exportData.summary}</p>

                        <div class="section-header">CORE TECHNICAL SKILLS</div>
                        <p style="font-size: 11pt; margin-bottom: 8px;"><strong>Core Stack:</strong> Java 17-21, Spring Boot 3.x, REST/SOAP APIs, PostgreSQL, Docker, Kubernetes, CI/CD.</p>
                        <div style="margin-top: 5px; margin-bottom: 20px;">
                            ${htmlSkillsList}
                        </div>

                        <div class="section-header">PROFESSIONAL EXPERIENCE</div>
                        <div style="margin-top: 10px;">
                            ${htmlExperience}
                        </div>

                        <div class="section-header">ARCHITECTURAL COMPETENCIES</div>
                        ${htmlArchitecturalCompetencies}

                        <div class="section-header">KEY OPEN SOURCE PROJECTS</div>
                        <div style="margin-top: 10px;">
                            ${htmlProjects}
                        </div>

                        <div class="section-header">EDUCATION & DEVELOPMENT</div>
                        ${htmlEducationDevelopment}

                        <div style="margin-top: 40px; font-size: 9pt; color: #999; text-align: center;">
                            Visualizations and Job Alignment Tool available at: ${window.location.href || 'codesapien.net'}
                        </div>
                    </div>
                </body>
                </html>
            `;

        const filename = `Yilmaz_Mustafa_Resume_Full.doc`;
        const blob = new Blob(['\ufeff', docContent], {
            type: 'application/msword'
        });

        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }

    document.getElementById('exportButton').addEventListener('click', exportMatchReport);
    document.getElementById('exportResumeButton').addEventListener('click', exportFullResume);
</script>
</body>
</html>
